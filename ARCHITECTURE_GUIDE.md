# 🏗️ Архитектурная схема приложения Horizons Case 2

## 📋 Обзор архитектуры

Horizons Case 2 - это полнофункциональная платформа для анализа металлического рынка, построенная по принципам слоистой архитектуры (Layered Architecture) с модульной структурой и использованием современных технологий.

## 🎯 Основные компоненты системы

### 1. **Frontend Layer (Презентационный слой)**
- **Технология**: React 18 + TypeScript + Material-UI
- **Контейнер**: `horizons_frontend`
- **Веб-сервер**: Nginx (в production)

### 2. **Backend Layer (Бизнес-логика)**
- **Технология**: FastAPI + Python 3.12
- **Контейнер**: `horizons_app`
- **Архитектура**: Монолитное приложение со слоистой архитектурой

### 3. **Data Layer (Слой данных)**
- **Технология**: PostgreSQL 15
- **Контейнер**: `horizons_postgres`

### 4. **Parser Layer (Слой парсинга)**
- **Назначение**: Парсинг данных с сайта 23met.ru
- **Интеграция**: Монтируется как volume в backend

### 5. **Reverse Proxy Layer**
- **Технология**: Nginx
- **Контейнер**: `horizons_nginx` (только в production)
- **Функции**: SSL termination, load balancing, static files


### 2. **Модульный монолит**
Backend организован по модулям внутри одного приложения:
- `auth/` - Аутентификация и авторизация
- `users/` - Управление пользователями
- `csv_data/` - Работа с данными CSV
- `parser/` - Парсинг данных
- `pricing/` - Алгоритмы ценообразования

### 3. **Repository Pattern**
Каждый модуль содержит:
- `models.py` - Модели данных (Pydantic)
- `service.py` - Бизнес-логика
- `controller.py` - API контроллеры

### 4. **Модульная структура Backend**
```
src/
├── main.py              # Точка входа приложения
├── api.py              # Регистрация роутов
├── auth/               # Модуль аутентификации
│   ├── controller.py   # API эндпоинты
│   ├── service.py      # Бизнес-логика
│   └── models.py       # Pydantic модели
├── users/              # Модуль пользователей
├── csv_data/           # Модуль работы с CSV
├── parser/             # Модуль парсинга
├── pricing/            # Модуль ценообразования
├── database/           # Общие компоненты БД
├── entities/           # Сущности данных
└── algorithms/         # Алгоритмы ценообразования
```

## 🏗️ текущая монолитная архитектура

```
┌─────────────────────────────────────────────────────────┐
│                Single FastAPI Application               │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │   Auth      │  │   CSV Data  │  │   Parser    │     │
│  │   Module    │  │   Module    │  │   Module    │     │
│  │             │  │             │  │             │     │
│  │ • controller│  │ • controller│  │ • controller│     │
│  │ • service   │  │ • service   │  │ • service   │     │
│  │ • models    │  │ • models    │  │ • models    │     │
│  └─────────────┘  └─────────────┘  └─────────────┘     │
│         │                │                │            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │
│  │   Users     │  │   Pricing   │  │   Shared    │     │
│  │   Module    │  │   Module    │  │   Modules   │     │
│  │             │  │             │  │             │     │
│  │ • controller│  │ • controller│  │ • database │     │
│  │ • service   │  │ • service   │  │ • entities  │     │
│  │ • models    │  │ • models    │  │ • logging   │     │
│  └─────────────┘  └─────────────┘  └─────────────┘     │
│                                                         │
│  ┌─────────────────────────────────────────────────────┐ │
│  │              Shared Database                        │ │
│  │              (PostgreSQL, csv)                           │ │
│  └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```


### 1. **Файловая система**
```
parser/
├── 23MET_DATA/           # Исходные данные парсинга
├── results/              # Результаты парсинга
│   ├── result_*.csv      # Сырые данные
│   └── preprocessing_result_*.csv  # Обработанные данные
└── GoogleHTML/           # HTML файлы для парсинга
```

### 2. **Конфигурация**
```
.env                      # Переменные окружения
docker-compose.yml        # Основная конфигурация
docker-compose.prod.yml   # Продакшен конфигурация
docker-compose.staging.yml # Staging конфигурация
```

---
